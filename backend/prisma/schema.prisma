// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
}



model Department {
  departmentId   Int      @id @default(autoincrement())
  departmentName String   @db.VarChar(100)
  Users          Users[]

  // Add timestamps to track when departments are created
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Role {
  roleId   Int      @id @default(autoincrement())
  roleName String 
  Users    Users[]
}

model Users {
  userId       Int      @id @default(autoincrement())
  firstName    String   @db.VarChar(50)
  lastName     String   @db.VarChar(50)
  email        String   @unique @db.VarChar(255)
  password     String   @db.Text
  roleId       Int
  departmentId Int

  Request Request[]
  
  // Timestamps are a "Must-Have" for debugging later
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  Role       Role       @relation(fields: [roleId], references: [roleId])
  Department Department @relation(fields: [departmentId], references: [departmentId])

  // Added Indexes for performance
  @@index([roleId])
  @@index([departmentId])
}

model Request {
  requestId Int @id @default(autoincrement())
  requestBatchId Int
  requestedAmount Int 
  requestedDate DateTime @default(now())


  userId Int
  itemId Int

  Users Users @relation(fields: [userId], references: [userId])
  Items Items @relation(fields: [itemId], references: [itemId])

  @@index([userId])
  @@index([itemId])

  // Timestamps are a "Must-Have" for debugging later
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Suppliers{
  supplierId Int @id @default(autoincrement())
  supplierName String @unique
  Address String
  Description String @db.MediumText 
  contact String

  Shipements Shipments[]

  // Timestamps are a "Must-Have" for debugging later
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt  
}

model Shipments {
  shipmentId Int @id @default(autoincrement())
  GTIN Int @default(0)
  deliveryDate DateTime @default(now())
  shipmentBatchId Int
  experationDate DateTime 
  cost Int

  itemId Int
  supplierId Int

  Items Items @relation(fields: [itemId], references: [itemId])
  Suppliers Suppliers @relation(fields: [supplierId], references: [supplierId])

  @@index([itemId])
  @@index([supplierId])

  // Timestamps are a "Must-Have" for debugging later
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Categories{
  categoryId Int @id @default(autoincrement())
  categoryName String 
  description String @db.Text

  Items Items[]

  // Timestamps are a "Must-Have" for debugging later
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Items{
  itemId Int @id @default(autoincrement())
  itemName String 
  description String @db.MediumText
  remainingAmount Int
  dateModified DateTime @updatedAt

  categoryId Int

  Categories Categories @relation(fields: [categoryId], references: [categoryId])

  Shipements Shipments[]
  Request Request[]

  @@index([categoryId])

  // Timestamps are a "Must-Have" for debugging later
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}